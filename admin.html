<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel | GAMING X LIGHT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#0b0b0f;
  color:#fff;
  padding:20px;
}
.container{
  max-width:1200px;
  margin:auto;
  background:#141414;
  padding:20px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.1);
}
h2,h3{margin-bottom:15px;color:#a855f7}
table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th,td{
  border:1px solid rgba(255,255,255,.15);
  padding:8px;
  text-align:center;
}
th{background:#1f1f1f}
button{
  padding:6px 10px;
  border:none;
  border-radius:6px;
  font-weight:700;
  cursor:pointer;
}
.deleteBtn{background:#ff4d4d;color:#000}
.editBtn{background:#facc15;color:#000}
.exportBtn{background:#a855f7;color:#000;margin-top:15px}
.topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
a{color:#a855f7;text-decoration:none;font-weight:700;margin-left:10px}
input,textarea{width:100%;padding:8px;margin:4px 0;border-radius:6px;border:none;background:#0f0f0f;color:#fff}
label{font-weight:700;margin-top:8px;display:block}
</style>
</head>
<body>

<div class="container">
  <div class="topbar">
    <h2>üõ° Admin Panel</h2>
    <div>
      <a href="index.html">‚¨Ö Home</a>
      <a href="#" onclick="logout()">Logout</a>
    </div>
  </div>

  <!-- Main Site Settings -->
  <h3>üåê Main Site Settings</h3>
  <label>Site Logo:</label>
  <input type="file" id="logoInput" accept="image/*">
  <button onclick="updateLogo()">Update Logo</button>

  <label>Site Name:</label>
  <input type="text" id="siteNameInput">
  <button onclick="updateSiteName()">Update Name</button>

  <label>Subtitle:</label>
  <input type="text" id="siteSubtitleInput">
  <button onclick="updateSubtitle()">Update Subtitle</button>

  <label>Products Section Title:</label>
  <input type="text" id="productsTitleInput">
  <button onclick="updateProductsTitle()">Update Title</button>

  <label>Official Links (JSON Array: [{name,url}])</label>
  <textarea id="officialLinksInput" rows="4"></textarea>
  <button onclick="updateLinks()">Update Links</button>

  <label>QR Image:</label>
  <input type="file" id="qrInput" accept="image/*">
  <button onclick="updateQR()">Update QR</button>

  <label>UPI ID:</label>
  <input type="text" id="upiInput">
  <button onclick="updateUPI()">Update UPI</button>

  <hr style="margin:20px 0;border-color:#555">

  <!-- Product Management -->
  <h3>üì¶ Products</h3>
  <table id="productsTable"></table>
  <button class="exportBtn" onclick="exportProducts()">‚¨á Export Products CSV</button>
  <h4>Add New Product</h4>
  <label>Name:</label>
  <input type="text" id="newProductName">
  <label>Price:</label>
  <input type="number" id="newProductPrice">
  <label>Badge:</label>
  <input type="text" id="newProductBadge">
  <label>Features (comma separated):</label>
  <input type="text" id="newProductFeatures">
  <button onclick="addProduct()">Add Product</button>

  <hr style="margin:20px 0;border-color:#555">

  <!-- Orders -->
  <h3>üì¶ Orders</h3>
  <table id="ordersTable"></table>
  <button class="exportBtn" id="exportOrdersBtn">‚¨á Export Orders CSV</button>

</div>

<script>
/* =============================
   üîê ADMIN PASSWORD
============================= */
const ADMIN_PASSWORD = "gaming_x_light";
let isAdmin = sessionStorage.getItem("isAdmin");
if(!isAdmin){
  const pass = prompt("üîê Enter Admin Password:");
  if(pass !== ADMIN_PASSWORD){
    alert("‚ùå Access Denied!");
    window.location.href = "index.html";
  }else{
    sessionStorage.setItem("isAdmin","true");
  }
}

function logout(){
  sessionStorage.removeItem("isAdmin");
  window.location.href = "index.html";
}

/* =============================
   MAIN SITE SETTINGS
============================= */
document.getElementById("siteNameInput").value = localStorage.getItem("siteName") || "GAMING X LIGHT STORE";
document.getElementById("siteSubtitleInput").value = localStorage.getItem("siteSubtitle") || "Premium Free Fire Tools & Bots";
document.getElementById("productsTitleInput").value = localStorage.getItem("productsTitle") || "GUILD GLORY BOT PLANS";
document.getElementById("officialLinksInput").value = localStorage.getItem("officialLinks") || JSON.stringify([
  {name:"YouTube : GAMING X LIGHT", url:"https://www.youtube.com/@shah_emam_raja"},
  {name:"Proof Channel", url:"https://t.me/glorybotsellproof"},
  {name:"Admin Support", url:"https://t.me/Gameralsor"}
],null,2);
document.getElementById("upiInput").value = localStorage.getItem("upiID") || "kumaripalak0@fam";

function updateLogo(){
  const file = document.getElementById("logoInput").files[0];
  if(!file){ alert("Select logo"); return; }
  const reader = new FileReader();
  reader.onload = e=>{ localStorage.setItem("siteLogo", e.target.result); alert("‚úÖ Logo updated"); }
  reader.readAsDataURL(file);
}
function updateSiteName(){ localStorage.setItem("siteName", document.getElementById("siteNameInput").value); alert("‚úÖ Site name updated"); }
function updateSubtitle(){ localStorage.setItem("siteSubtitle", document.getElementById("siteSubtitleInput").value); alert("‚úÖ Subtitle updated"); }
function updateProductsTitle(){ localStorage.setItem("productsTitle", document.getElementById("productsTitleInput").value); alert("‚úÖ Products section title updated"); }
function updateLinks(){
  try{
    const links = JSON.parse(document.getElementById("officialLinksInput").value);
    localStorage.setItem("officialLinks", JSON.stringify(links));
    alert("‚úÖ Links updated");
  }catch(e){ alert("‚ùå Invalid JSON"); }
}
function updateQR(){
  const file = document.getElementById("qrInput").files[0];
  if(!file){ alert("Select QR image"); return; }
  const reader = new FileReader();
  reader.onload = e=>{ localStorage.setItem("qrImage", e.target.result); alert("‚úÖ QR updated"); }
  reader.readAsDataURL(file);
}
function updateUPI(){ localStorage.setItem("upiID", document.getElementById("upiInput").value); alert("‚úÖ UPI updated"); }

/* =============================
   PRODUCTS MANAGEMENT
============================= */
let PRODUCTS = JSON.parse(localStorage.getItem("products")||"[]");
const productsTable = document.getElementById("productsTable");

function renderProducts(){
  productsTable.innerHTML = `<tr>
    <th>#</th><th>Name</th><th>Price</th><th>Badge</th><th>Features</th><th>Action</th>
  </tr>`;
  if(PRODUCTS.length===0){
    const row=productsTable.insertRow();
    const cell=row.insertCell();
    cell.colSpan=6;
    cell.innerText="No products found.";
    cell.style.opacity=".6";
    return;
  }
  PRODUCTS.forEach((p,i)=>{
    const row=productsTable.insertRow();
    row.insertCell().innerText=i+1;
    row.insertCell().innerText=p.name;
    row.insertCell().innerText=p.price;
    row.insertCell().innerText=p.badge;
    row.insertCell().innerText=p.features.join(", ");
    const cell=row.insertCell();
    const editBtn=document.createElement("button");
    editBtn.className="editBtn"; editBtn.innerText="Edit";
    editBtn.onclick=()=>{
      const newName=prompt("Product name",p.name); if(newName)p.name=newName;
      const newPrice=prompt("Price",p.price); if(newPrice)p.price=newPrice;
      const newBadge=prompt("Badge",p.badge); if(newBadge)p.badge=newBadge;
      const newFeatures=prompt("Features (comma separated)",p.features.join(","));
      if(newFeatures)p.features=newFeatures.split(",");
      saveProducts();
    };
    const delBtn=document.createElement("button");
    delBtn.className="deleteBtn"; delBtn.innerText="Delete";
    delBtn.style.marginLeft="5px";
    delBtn.onclick=()=>{ if(confirm("Delete this product?")){ PRODUCTS.splice(i,1); saveProducts(); } };
    cell.appendChild(editBtn);
    cell.appendChild(delBtn);
  });
}

function addProduct(){
  const name=document.getElementById("newProductName").value;
  const price=document.getElementById("newProductPrice").value;
  const badge=document.getElementById("newProductBadge").value;
  const features=document.getElementById("newProductFeatures").value.split(",");
  if(!name||!price){ alert("Name & Price required"); return; }
  PRODUCTS.push({name,price,badge,features});
  saveProducts();
  document.getElementById("newProductName").value="";
  document.getElementById("newProductPrice").value="";
  document.getElementById("newProductBadge").value="";
  document.getElementById("newProductFeatures").value="";
}

function saveProducts(){
  localStorage.setItem("products", JSON.stringify(PRODUCTS));
  renderProducts();
}

/* Export products CSV */
function exportProducts(){
  let csv="Name,Price,Badge,Features\n";
  PRODUCTS.forEach(p=>{ csv+=`${p.name},${p.price},${p.badge},"${p.features.join(";")}"\n`; });
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="products.csv"; a.click();
}

renderProducts();

/* =============================
   ORDERS MANAGEMENT
============================= */
let orders = JSON.parse(localStorage.getItem("orders")||"[]");
const ordersTable = document.getElementById("ordersTable");

function renderOrders(){
  ordersTable.innerHTML=`<tr>
    <th>#</th><th>Username</th><th>Email</th><th>Product</th>
    <th>Price</th><th>UTR</th><th>Guild UID</th>
    <th>Region</th><th>Telegram</th><th>WhatsApp</th><th>Action</th>
  </tr>`;
  if(orders.length===0){
    const row=ordersTable.insertRow();
    const cell=row.insertCell();
    cell.colSpan=11;
    cell.innerText="No orders found.";
    cell.style.opacity=".6";
    return;
  }
  orders.forEach((o,i)=>{
    const row=ordersTable.insertRow();
    row.insertCell().innerText=i+1;
    row.insertCell().innerText=o.username||"Guest";
    row.insertCell().innerText=o.email||"N/A";
    row.insertCell().innerText=o.product;
    row.insertCell().innerText=o.price;
    row.insertCell().innerText=o.utr;
    row.insertCell().innerText=o.uid;
    row.insertCell().innerText=o.region;
    row.insertCell().innerText=o.telegram;
    row.insertCell().innerText=o.whatsapp;
    const cell=row.insertCell();
    const delBtn=document.createElement("button");
    delBtn.className="deleteBtn"; delBtn.innerText="Delete";
    delBtn.onclick=()=>{ if(confirm("Delete this order?")){ orders.splice(i,1); localStorage.setItem("orders",JSON.stringify(orders)); renderOrders(); } };
    cell.appendChild(delBtn);
  });
}

document.getElementById("exportOrdersBtn").addEventListener("click",()=>{
  let csv="Username,Email,Product,Price,UTR,Guild UID,Region,Telegram,WhatsApp\n";
  orders.forEach(o=>{ csv+=`${o.username},${o.email},${o.product},${o.price},${o.utr},${o.uid},${o.region},${o.telegram},${o.whatsapp}\n`; });
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="orders.csv"; a.click();
});

renderOrders();
</script>

</body>
</html>
